{% extends 'layouts/base.html' %}
{% load static %}
{% load martortags %}
{% block css %}
<link href="{% static 'martor/css/martor.bootstrap.min.css' %}" type="text/css" media="all" rel="stylesheet" />
<link href="{% static 'plugins/css/ace.min.css' %}" type="text/css" media="all" rel="stylesheet" />
<link href="{% static 'martor/css/martor.min.css' %}" type="text/css" media="all" rel="stylesheet" />
{% endblock %}
{% block content %}
<script src="https://cdn.tailwindcss.com/"></script>
<div class="flex justify-center items-center w-full min-h-screen bg-white">
    <div>
        <form method="post" action="{% url 'comments:comment_add' member_id %}">
            {% csrf_token %}
            {{ form.media }}
            {{ form }}
            <div class="flex justify-end">
                <button type="submit"
                    class="text-sm font-semibold bg-[#4F46E5] text-white py-2 rounded px-3">Post</button>
            </div>
        </form>
        <h2 class="text-xl font-bold mt-8 mb-2">留言列表</h2>
        <ul class="mt-4">
            {% for comment in comments %}
            <li class="bg-white shadow-md rounded p-4 mb-4">
                <div style="color: black;">{{ comment.content|safe_markdown }}</div>
                <p class="text-sm text-gray-500">時間：{{ comment.created_at|date:"Y-m-d H:i:s" }}</p>
                <form action="{% url 'comments:delete' pk=comment.id %}" method="post" class="inline">
                    {% csrf_token %}
                    <button type="submit" class="bg-red-500 text-white px-2 py-1 rounded">刪除</button>
                </form>
            </li>
            {% empty %}
            <li class="text-gray-500">尚無留言</li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}
{% block js %}
<script type="text/javascript" src="{% static 'plugins/js/highlight.min.js' %}"></script>
<script>
    $('.martor-preview pre').each(function (i, block) {
        hljs.highlightBlock(block);
    });
</script>
{% endblock %}